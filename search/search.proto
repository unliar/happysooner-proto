syntax = "proto3";

package search;

// æœç´¢ç±»å‹
enum SearchTypes {
    NoneType                                                     = 0;
    Article                                                      = 1; // æ–‡ç« ç±»å‹
    Author                                                       = 2; // ä½œè€…    
}

message ResultItem {
    SearchTypes Type                                             = 1; // æœç´¢ç±»å‹
    string       Key                                             = 2; // è¿”å›çš„æ•°æ®ID                                                 
}

// æœç´¢ç»“æœ
message SearchResult {
    repeated ResultItem Results                                  = 1; 
}

// åˆ é™¤æœç´¢
message DelSearchRequest {
    string Collection                                            = 1;// ç±»ä¼¼äºdatabaseçš„æ¦‚å¿µ
    string Bucket                                                = 2;// ç±»ä¼¼äºè¡¨çš„æ¦‚å¿µ
    string Object                                                = 3;// è¿™ä¸ªç±»ä¼¼äºkeyçš„æ¦‚å¿µ æœç´¢ä¼šæ ¹æ®valueæœç´¢keyğŸ”
}
// é”™è¯¯ç±»å‹
enum SearchErrors {
    NoneError                                                    = 0;        // é»˜è®¤å€¼
    SearchCommonError                                            = 4000001;  // é€šç”¨error
}

message ErrorResponse {
    SearchErrors ErrorInfo                                       = 1;
}
// æ’å…¥æœç´¢æ•°æ®è¯·æ±‚
message PostSearchSourceRequest {
    string Collection                                            = 1;// ç±»ä¼¼äºdatabaseçš„æ¦‚å¿µ
    string Bucket                                                = 2;// ç±»ä¼¼äºè¡¨çš„æ¦‚å¿µ
    string Object                                                = 3;// è¿™ä¸ªç±»ä¼¼äºkeyçš„æ¦‚å¿µ æœç´¢ä¼šæ ¹æ®valueæœç´¢keyğŸ”
    string Text                                                  = 4;// æ•°æ®åˆ†è¯å†…å®¹
}

// è·å–æœç´¢ç»“æœ
message GetSearchRequest {
    string Collection                                            = 1;// ç±»ä¼¼äºdatabaseçš„æ¦‚å¿µ
    string Bucket                                                = 2;// ç±»ä¼¼äºè¡¨çš„æ¦‚å¿µ
    string Text                                                  = 4;// æœç´¢æ•°æ®
}
service searchSV {
    // è·å–æœç´¢ç»“æœ
    rpc GetSearchByType (GetSearchRequest) returns (SearchResult);
    
    // åˆ é™¤æœç´¢ç»“æœ
    rpc DelSearchByType (DelSearchRequest) returns (ErrorResponse);

    // æ’å…¥æœç´¢èµ„æºæ•°æ®
    rpc PostSearchSource(PostSearchSourceRequest) returns (ErrorResponse);
}