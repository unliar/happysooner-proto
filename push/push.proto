syntax = "proto3";

package push;
option go_package = "./push;push";
// option go_package = "github.com/unliar/happysooner-proto/v2/push";

enum SendType {
  NoneSendType = 0; // é»˜è®¤å€¼
  Mail = 1;         // é‚®ç®±
  Phone = 2;        // æ‰‹æœº
}

message PushCaptchaRequest {
  string Code = 1;       // éªŒè¯ç 
  string Sender = 2;     // å‘é€äºº
  SendType Type = 3;     // å‘é€ç±»å‹
  int64 UID = 4;         // è¢«å‘é€äººçš„UID
  string Account = 5;    // è¢«å‘é€äººçš„è´¦æˆ·
  string NationCode = 6; // æ‰‹æœºå·åŒºå·
}

enum PushErrors {
  None = 0;                  // é»˜è®¤å€¼
  PushCommonError = 4000001; // é€šç”¨error
}

message ErrorResponse {
  PushErrors ErrorInfo = 1; // é”™è¯¯ä¿¡æ¯
}
message PushEmailNotificationRequest {
  string To = 1;      // å‘é€åˆ°
  string Html = 2;    // å‘é€å†…å®¹
  string Subject = 3; // ä¸»é¢˜å†…å®¹
}
message GetCaptchaVerifyRequest {
  string Code = 1;    // éªŒè¯ç 
  string Account = 2; // è¢«å‘é€äººçš„è´¦æˆ·
  int64 UID = 3;      // è¢«å‘é€äººçš„UID
  SendType Type = 4;  // éªŒè¯ç±»å‹
}

message StoreOrderMailRequest {
  string OrderID = 1;  // æ¥æºè®¢å•
  string HTML = 2;     // é‚®ä»¶ä¿¡æ¯
  string ExpireIn = 3; // æœ‰æ•ˆæ—¶é—´
}

message PushWechatWorkGroupRobotNotificationRequest {
  string Content = 1; // å†…å®¹ä¿¡æ¯
  int64 Retry = 2;    // é‡è¯•æ¬¡æ•°
}

message PushWechatTemplateMessageRequest {
  string ToUser = 1; // ç”¨æˆ·çš„OpenID
  string Type = 2;   // é»˜è®¤å¾®ä¿¡ mp
  string URL = 3;    // æ¨¡æ¿æ¶ˆæ¯åœ°å€
  string Data = 4;   // æ•°æ®æ¶ˆæ¯
}

enum CommonMessageType {
  NoneMessageType = 0; // é»˜è®¤å€¼
  Email = 1;           // é‚®ç®±æ¶ˆæ¯
  SMS = 2;             // çŸ­ä¿¡æ¶ˆæ¯
  Chat = 3;            // èŠå¤©æ¶ˆæ¯
  Bot = 4;             // æœºå™¨äººæ¶ˆæ¯  - ä¼ä¸šå¾®ä¿¡ + é’‰é’‰ + TG + é£ä¹¦
  WechatTemplateMessage = 5; // å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯
}

message SenderInfo {
  string IP = 1;          // å‘é€æ–¹IP
  string ServiceName = 2; // å‘é€æ–¹åç§°
}

// é‚®ä»¶æ¶ˆæ¯
message EmailNotification {
  string To = 1;      // ç›®æ ‡é‚®ç®±
  string Html = 2;    // å‘é€å†…å®¹
  string Subject = 3; // æ ‡é¢˜
}

// æ‰‹æœºçŸ­ä¿¡æ¶ˆæ¯
message SMSNotification {
  string TemplateID = 1;              // çŸ­ä¿¡æ¨¡æ¿ID
  string PhoneNumber = 2;             // æ‰‹æœºå·
  string NationCode = 3;              // æ‰‹æœºå·åŒºå·
  repeated string TemplateParams = 4; // çŸ­ä¿¡æ¨¡æ¿å‚æ•°
}
// æœºå™¨äººæ¶ˆæ¯ç±»å‹
enum BotNotificationType {
  BotNotificationTypeNoneType = 0; // åˆå§‹å€¼ v2
  WechatWork = 1;                  // å¾®ä¿¡æœºå™¨äººæ¶ˆæ¯  1
  FeiShu = 2;                      // é£ä¹¦æœºå™¨äººæ¶ˆæ¯  2
  DingTalk = 3;                    // é’‰é’‰æœºå™¨äººæ¶ˆæ¯  4
  GoTify = 4;                      // gotify æ¶ˆæ¯    - Android
  Bark = 5;                        // Bark   æ¶ˆæ¯    - iOS
}

// æœºå™¨äººæ¶ˆæ¯
message BotNotification {
  string Content = 1;           // æ¶ˆæ¯å†…å®¹ markdown
  BotNotificationType Type = 2; // æ¶ˆæ¯ç±»å‹
}

// æœºå™¨äººæ¶ˆæ¯v2
// æ¶ˆæ¯ç±»å‹ 1 ä¼ä¸šğŸ¤– 2 é£ä¹¦ğŸ¤– 4 é’‰é’‰ğŸ¤– 8 PushPlusğŸ¤–
message BotNotificationV2 {
  string Content = 1; // æ¶ˆæ¯å†…å®¹ markdown
  uint64 Type = 2;
}

message TemplateMessageDataObject {
  string Value = 1; // æ•°å€¼
  string Color = 2; // æ–‡æœ¬è‰²å·
}

message Miniprogram {
  string AppID = 1;    // å°ç¨‹åºåº”ç”¨ID
  string PagePath = 2; // å°ç¨‹åºåº”ç”¨è·¯å¾„
}

// å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯
message WechatTemplateMessageNotification {
  string ToUser = 1;                               // ç”¨æˆ·openID
  string TemplateID = 2;                           // æ¨¡æ¿ID
  string URL = 3;                                  // æ¨¡æ¿æ¶ˆæ¯è¯¦æƒ…URL
  map<string, TemplateMessageDataObject> Data = 4; // æ¨¡æ¿å¡«å……å€¼
  Miniprogram Miniprogram = 5;                     // å°ç¨‹åºé…ç½®
}

message PushCommonMessageRequest {
  CommonMessageType MessageType = 1;       // æ¶ˆæ¯ç±»å‹
  SenderInfo SenderInfo = 2;               // æ¨é€æ–¹ä¿¡æ¯
  EmailNotification EmailNotification = 3; // é‚®ä»¶æ¶ˆæ¯ç»“æ„
  SMSNotification SMSNotification = 4;     // çŸ­ä¿¡æ¶ˆæ¯ç»“æ„
  BotNotification BotNotification = 5;     // æœºå™¨äººæ¶ˆæ¯ç»“æ„
  WechatTemplateMessageNotification WechatTemplateMessageNotification = 6;
  BotNotificationV2 BotNotificationV2 = 7; // æœºå™¨äººæ¶ˆæ¯v2
}

service pushSV {

  // å‘é€éªŒè¯ç 
  rpc PushCaptcha(PushCaptchaRequest) returns (ErrorResponse);

  // æ ¡éªŒéªŒè¯ç 
  rpc GetCaptchaVerify(GetCaptchaVerifyRequest) returns (ErrorResponse);

  // å‘é€é‚®ä»¶é€šçŸ¥
  rpc PushEmailNotification(PushEmailNotificationRequest)
      returns (ErrorResponse);

  // å­˜å‚¨è®¢å•ä¸´æ—¶é‚®ä»¶ä¿¡æ¯
  rpc StoreOrderMail(StoreOrderMailRequest) returns (ErrorResponse);

  // æ¶ˆè´¹è®¢å•é‚®ä»¶ä¿¡æ¯
  rpc PostOrderMail(StoreOrderMailRequest) returns (ErrorResponse);

  // å‘é€å¾®ä¿¡æœºå™¨äººé€šçŸ¥
  rpc PushWechatWorkGroupRobotNotification(
      PushWechatWorkGroupRobotNotificationRequest) returns (ErrorResponse);

  // å‘é€å…¬ä¼—å·æ¨¡æ¿æ¶ˆæ¯
  rpc PushWechatTemplateMessage(PushWechatTemplateMessageRequest)
      returns (ErrorResponse);

  // é€šç”¨å‘é€æ¶ˆæ¯æ¥å£
  rpc PushCommonMessage(PushCommonMessageRequest) returns (ErrorResponse);
}